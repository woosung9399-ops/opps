<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>ì˜¤ëŠ˜ì˜ íƒ€ë¡œ</title>
<meta name="description" content="ë²„íŠ¼ì„ ëˆ„ë¥¼ ë•Œë§ˆë‹¤ ë¬´ì œí•œìœ¼ë¡œ ì¹´ë“œë¥¼ ë½‘ê³ , ì‚¬ë‘/ì¼/ê¸ˆì „ í•´ì„ê³¼ ê³µìœ , íˆìŠ¤í† ë¦¬, ì‹œë“œ ë§í¬ë¥¼ ì§€ì›í•©ë‹ˆë‹¤." />
<style>
  :root{
    --bg:#0f0f14;--card:#181820;--accent:#7c5cff;--text:#f5f5f7;--muted:#b9b8c6;--good:#58d68d;--bad:#ff7675;
    --ring:rgba(124,92,255,.6);
  }
  *{box-sizing:border-box}
  html:focus-within { scroll-behavior:smooth }
  body{
    margin:0; font-family: ui-sans-serif, system-ui, -apple-system, "Pretendard","Segoe UI",sans-serif;
    background: radial-gradient(1200px 600px at 50% -10%, #222 0%, #111 40%, #0a0a0f 100%);
    color:var(--text); display:flex; min-height:100dvh; align-items:center; justify-content:center; padding:24px;
  }
  .app{width:100%; max-width:780px}
  header{display:flex; align-items:center; justify-content:space-between; margin-bottom:14px}
  h1{font-size:1.25rem; margin:0; letter-spacing:.02em}
  .date{color:var(--muted); font-size:.9rem}
  .wrap{
    background:linear-gradient(180deg, rgba(255,255,255,.06), rgba(255,255,255,.02));
    border:1px solid rgba(255,255,255,.08); border-radius:16px; padding:16px 16px 20px;
    box-shadow: 0 10px 40px rgba(0,0,0,.35), inset 0 1px 0 rgba(255,255,255,.06);
  }
  .grid{display:grid; grid-template-columns:1fr; gap:14px}
  @media (min-width:920px){ .grid{grid-template-columns: 320px 1fr} }
  .cardbox{display:flex; justify-content:center; perspective:1000px;}
  .card{
    width:min(80vw,300px); height:450px; border-radius:16px; position:relative; cursor:pointer;
    transform-style:preserve-3d; transition:transform .8s cubic-bezier(.2,.7,.2,1);
  }
  .card.flipped{transform:rotateY(180deg)}
  @media (prefers-reduced-motion: reduce){ .card{ transition:none } }
  .face{position:absolute; inset:0; backface-visibility:hidden; border-radius:16px; overflow:hidden;
    display:flex; align-items:center; justify-content:center; box-shadow:0 16px 40px rgba(0,0,0,.45)}
  .front{
    background:
      radial-gradient(400px 200px at 50% 0%, rgba(124,92,255,.25), transparent 60%),
      linear-gradient(135deg, #1f1b2e, #141420);
    border:1px solid rgba(124,92,255,.4);
  }
  .back{
    transform:rotateY(180deg);
    background:
      radial-gradient(500px 220px at 50% -5%, rgba(124,92,255,.22), transparent 60%),
      linear-gradient(160deg, #111318, #171924);
    border:1px solid rgba(255,255,255,.08);
    padding:16px;
  }
  .sigil{
    width:70%; aspect-ratio:1/1; border-radius:50%; border:2px dashed rgba(255,255,255,.14);
    display:flex; align-items:center; justify-content:center; color:#fff; font-size:3rem; user-select:none;
    background: radial-gradient(60% 60% at 50% 45%, rgba(255,255,255,.06), transparent);
  }
  .brand{position:absolute; inset:auto 14px 14px auto; font-size:.8rem; color:var(--muted);
    background:rgba(0,0,0,.25); padding:6px 10px; border-radius:999px; border:1px solid rgba(255,255,255,.08)}
  .name{font-weight:700; text-align:center; margin:6px 0 8px; letter-spacing:.02em}
  .dir{font-size:.85rem; color:var(--muted); text-align:center; margin-bottom:8px}
  .keywords{display:flex; gap:8px; flex-wrap:wrap; justify-content:center; margin:6px 0 10px}
  .pill{font-size:.85rem; padding:6px 10px; border-radius:999px; background:rgba(255,255,255,.06); border:1px solid rgba(255,255,255,.08)}
  .advice{font-size:1rem; line-height:1.55; background:rgba(124,92,255,.09);
    border:1px solid rgba(124,92,255,.35); padding:12px 14px; border-radius:12px; text-align:center}
  .advice.good{background:rgba(88,214,141,.08); border-color:rgba(88,214,141,.4)}
  .advice.bad{background:rgba(255,118,117,.08); border-color:rgba(255,118,117,.45)}
  .btns{display:flex; gap:8px; flex-wrap:wrap; justify-content:center; margin-top:10px}
  button{
    all:unset; padding:10px 14px; border-radius:10px; border:1px solid rgba(255,255,255,.18);
    background:rgba(255,255,255,.06); cursor:pointer; font-weight:600; letter-spacing:.01em; text-align:center
  }
  button:focus-visible{ outline:3px solid var(--ring); outline-offset:2px; border-color:transparent }
  button.primary{background:linear-gradient(180deg, #7c5cff, #5f45e6); border-color:#7c5cff}
  button.ghost[aria-selected="true"]{outline:2px solid var(--accent)}
  .panel{
    background: rgba(255,255,255,.04); border:1px solid rgba(255,255,255,.08); border-radius:14px; padding:12px
  }
  .panel h3{margin:0 0 8px; font-size:1rem}
  .list{display:grid; gap:8px}
  .line{font-size:.98rem; line-height:1.55; background:rgba(255,255,255,.04); border:1px solid rgba(255,255,255,.08); padding:10px 12px; border-radius:10px}
  footer{margin-top:12px; text-align:center; color:var(--muted); font-size:.85rem}
  .row{display:grid; gap:10px}
  @media(min-width:560px){ .row{grid-template-columns:1fr 1fr} }
  .history{display:grid; gap:8px; max-height:210px; overflow:auto; padding-right:4px}
  .hist-item{display:flex; align-items:center; gap:8px; font-size:.92rem; padding:8px 10px; background:rgba(255,255,255,.03); border:1px solid rgba(255,255,255,.08); border-radius:10px}
  .dot{width:8px; height:8px; border-radius:50%}
  .dot.u{background:var(--good)} .dot.r{background:var(--bad)}
  .kbd{font-family:ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, monospace; font-size:.85rem; background:rgba(255,255,255,.06); border:1px solid rgba(255,255,255,.14); padding:.1rem .4rem; border-radius:6px}
</style>
</head>
<body>
  <div class="app">
    <header>
      <h1>ì˜¤ëŠ˜ì˜ íƒ€ë¡œ</h1>
      <div class="date" id="dateText" aria-live="polite"></div>
    </header>

    <div class="wrap" role="region" aria-label="íƒ€ë¡œ ì¹´ë“œ ì˜ì—­">
      <div class="grid">
        <!-- ì¹´ë“œ -->
        <div>
          <div class="cardbox">
            <div id="card" class="card" role="button" tabindex="0" aria-pressed="false" aria-label="ì¹´ë“œ ë’¤ì§‘ê¸°">
              <div class="face front" title="ì¹´ë“œë¥¼ íƒ­í•´ ë’¤ì§‘ê¸°">
                <div class="sigil">ğŸ”®</div>
                <div class="brand">TAROT Â· RANDOM</div>
              </div>
              <div class="face back">
                <div style="width:100%;">
                  <div class="name" id="cardName">ì¹´ë“œë¥¼ ë½‘ì•„ë³´ì„¸ìš”</div>
                  <div class="dir" id="cardDir">ì •/ì—­ë°©í–¥</div>
                  <div class="keywords" id="keywords"></div>
                  <div class="advice" id="advice">ì—¬ê¸°ì— ë©”ì‹œì§€ê°€ í‘œì‹œë©ë‹ˆë‹¤.</div>
                </div>
              </div>
            </div>
          </div>
          <div class="btns" style="margin-top:10px">
            <button id="drawBtn" class="primary" title="ìƒˆ ì¹´ë“œë¥¼ ë½‘ìŠµë‹ˆë‹¤ (ë‹¨ì¶•í‚¤: D)">ì¹´ë“œ ë½‘ê¸°</button>
            <button id="flipBtn" title="ì¹´ë“œë¥¼ ë’¤ì§‘ìŠµë‹ˆë‹¤ (ë‹¨ì¶•í‚¤: F)">ì¹´ë“œ ë’¤ì§‘ê¸°</button>
            <button id="shareBtn" title="í…ìŠ¤íŠ¸ë¡œ ê³µìœ í•˜ê±°ë‚˜ ë³µì‚¬í•©ë‹ˆë‹¤">ê³µìœ </button>
            <button id="linkBtn" title="ê°™ì€ ê²°ê³¼ë¥¼ ì—´ ìˆ˜ ìˆëŠ” ë§í¬ ìƒì„±">ë§í¬</button>
            <button id="resetBtn" title="í™”ë©´ ì´ˆê¸°í™”">ì´ˆê¸°í™”</button>
          </div>
          <div class="date" style="margin-top:8px">ë‹¨ì¶•í‚¤: <span class="kbd">D</span> ë½‘ê¸° Â· <span class="kbd">F</span> ë’¤ì§‘ê¸° Â· <span class="kbd">L</span> ë§í¬</div>
        </div>

        <!-- ìš°ì¸¡ íŒ¨ë„ -->
        <div class="row">
          <div>
            <div class="btns" role="tablist" aria-label="ë¶„ì•¼ ì„ íƒ">
              <button class="ghost" id="tabGeneral" role="tab" aria-selected="true">ì „ì²´</button>
              <button class="ghost" id="tabLove" role="tab" aria-selected="false">ì‚¬ë‘</button>
              <button class="ghost" id="tabWork" role="tab" aria-selected="false">ì¼</button>
              <button class="ghost" id="tabMoney" role="tab" aria-selected="false">ê¸ˆì „</button>
            </div>
            <div class="panel" id="panel">
              <h3 id="panelTitle">ì˜¤ëŠ˜ì˜ í•µì‹¬</h3>
              <div class="list">
                <div class="line" id="line1">ì¹´ë“œë¥¼ ë½‘ìœ¼ë©´ ë¶„ì•¼ë³„ í•´ì„ì´ í‘œì‹œë©ë‹ˆë‹¤.</div>
                <div class="line" id="line2"></div>
                <div class="line" id="line3"></div>
              </div>
            </div>
          </div>
          <div>
            <div class="panel">
              <h3 style="margin-bottom:8px">ìµœê·¼ ë½‘ì€ ì¹´ë“œ</h3>
              <div class="history" id="history" aria-live="polite"></div>
              <div class="date" style="margin-top:6px">ìµœëŒ€ 10ê°œ ì €ì¥ Â· ê¸°ê¸° ë¡œì»¬ì—ë§Œ ë³´ê´€ë©ë‹ˆë‹¤</div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <footer>ë¬´ì œí•œ ëœë¤ Â· ê³µìœ /ë§í¬/íˆìŠ¤í† ë¦¬ ì§€ì› Â· <span id="ver">v2</span></footer>
  </div>

<script>
/**************** íƒ€ë¡œ ë°ì´í„°(ë©”ì´ì € 22ì¥) ****************/
const MAJOR = [
  { n:"0. ë°”ë³´ (The Fool) ğŸƒ",
    u:["ìƒˆì¶œë°œ","ì¦‰í¥","ììœ "], r:["ë¬´ëª¨","ë¶ˆì•ˆì •","ë°©í™©"],
    au:"ê°€ë²¼ìš´ í˜¸ê¸°ì‹¬ìœ¼ë¡œ ì‹œì‘í•´ë„ ì¢‹ì•„ìš”. ì‘ì€ ì²«ê±¸ìŒì„!",
    ar:"ì¦‰í¥ ê²°ì •ì„ ì ì‹œ ë¯¸ë£¨ê³ , ê¸°ë°˜ì„ ë¨¼ì € ë‹¤ì§€ì„¸ìš”." },
  { n:"I. ë§ˆë²•ì‚¬ (The Magician) âœ¨",
    u:["ì˜ì§€","ì°½ì¡°","ì»¤ë®¤ë‹ˆì¼€ì´ì…˜"], r:["ì†ì„ìˆ˜","ì‚°ë§Œ","ì§‘ì¤‘ë ¥ì €í•˜"],
    au:"ë§ê³¼ í–‰ë™ì„ ì •ë ¬í•˜ì„¸ìš”. ì˜¤ëŠ˜ì€ ì‹¤í–‰ë ¥ì´ í•µì‹¬!",
    ar:"í•œ ë²ˆì— í•˜ë‚˜â€”ìš°ì„ ìˆœìœ„ë¥¼ ì •í•˜ê³  ì¡ìŒì„ ì¤„ì´ì„¸ìš”." },
  { n:"II. ì—¬ì‚¬ì œ (The High Priestess) ğŸŒ™",
    u:["ì§ê´€","ë¹„ë°€","ë‚´ë©´"], r:["í˜¼ë€","ì–µì••ëœê°ì •","í”¼ìƒ"],
    au:"ì¡°ìš©íˆ ê´€ì°°í•˜ê³ , ë‚´ë©´ì˜ ì‹ í˜¸ë¥¼ ë¯¿ì–´ë³´ì„¸ìš”.",
    ar:"ê²‰í•¥ê¸°ë¡œ íŒë‹¨í•˜ì§€ ë§ê³ , ì¶©ë¶„íˆ ë“¤ì—¬ë‹¤ë³´ì„¸ìš”." },
  { n:"III. ì—¬í™©ì œ (The Empress) ğŸŒ¿",
    u:["í’ìš”","ëŒë´„","ì°½ì˜"], r:["ê³¼ì‰","ì§€ë‚˜ì¹œì˜ì¡´","ì •ì²´"],
    au:"ê´€ê³„ì™€ ëª¸ì— ì˜ì–‘ì„! ë„‰ë„‰í•¨ì´ í–‰ìš´ì„ ë¶€ë¦…ë‹ˆë‹¤.",
    ar:"ê³¼í•œ ë°°ë ¤ëŠ” ë²ˆì•„ì›ƒì„ ë¶€ë¦…ë‹ˆë‹¤. ì„ ì„ ê¸‹ê¸°." },
  { n:"IV. í™©ì œ (The Emperor) ğŸ›¡ï¸",
    u:["ì§ˆì„œ","í†µì œ","ê¶Œìœ„"], r:["ì™„ê³ ","ê²½ì§","ê¶Œìœ„ì¶©ëŒ"],
    au:"ê·œì¹™Â·ì¼ì •Â·ìš°ì„ ìˆœìœ„ë¥¼ ëª…í™•íˆ í•˜ì„¸ìš”.",
    ar:"ìœµí†µì„±ì„ ìƒì§€ ë§ˆì„¸ìš”. í˜‘ì˜ê°€ í•´ê²°ì±…ì…ë‹ˆë‹¤." },
  { n:"V. êµí™© (The Hierophant) ğŸ“–",
    u:["ì „í†µ","ë©˜í† ","í•™ìŠµ"], r:["í˜•ì‹ì£¼ì˜","ê³ ì§‘","íì‡„ì„±"],
    au:"ë§¤ë‰´ì–¼/ì„ ë°°ì—ê²Œì„œ íŒíŠ¸ë¥¼ ì–»ì„ ë•Œì˜ˆìš”.",
    ar:"ê´€ìŠµì´ ë‹µì€ ì•„ë‹™ë‹ˆë‹¤. ëª©ì ì„ ë¨¼ì € ìƒê°í•˜ì„¸ìš”." },
  { n:"VI. ì—°ì¸ (The Lovers) â¤ï¸",
    u:["ì„ íƒ","ìœ ëŒ€","ì¡°í™”"], r:["ìš°ìœ ë¶€ë‹¨","ë¶ˆí˜‘","ìœ í˜¹"],
    au:"ê°€ì¹˜ì— ë§ëŠ” ì„ íƒì„â€”ì§„ì‹¬ì´ ê¸°ì¤€ì…ë‹ˆë‹¤.",
    ar:"ê°ì •ê³¼ ì´ìµì´ ì¶©ëŒí•˜ë©´, ê²½ê³„ë¶€í„° ì •í•˜ì„¸ìš”." },
  { n:"VII. ì „ì°¨ (The Chariot) ğŸ",
    u:["ëŒíŒŒ","ì†ë„","ìŠ¹ë¦¬"], r:["í­ì£¼","ì‚°ë§Œ","í†µì œë¶ˆëŠ¥"],
    au:"ì§‘ì¤‘Â·ì†ë„ ìœ ì§€! ì˜¤ëŠ˜ì€ ë°€ì–´ë¶™ì´ëŠ” ë‚ .",
    ar:"ë¸Œë ˆì´í¬ë„ ì‹¤ë ¥. ì†ë„ë¥¼ ì¤„ì—¬ ë°©í–¥ì„ ì¡ìœ¼ì„¸ìš”." },
  { n:"VIII. í˜ (Strength) ğŸ¦",
    u:["ìš©ê¸°","ì¸ë‚´","ìê¸°ì¡°ì ˆ"], r:["ë¶ˆì•ˆ","ê³¼ë¯¼","ì˜ìš•ì €í•˜"],
    au:"ë¶€ë“œëŸ¬ìš´ ëˆê¸°ê°€ ê°•í•©ë‹ˆë‹¤. ìì‹ ì„ ë¯¿ì–´ì£¼ì„¸ìš”.",
    ar:"ì–µì§€ë¡œ ë²„í‹°ì§€ ë§ê³ , íšŒë³µ ì‹œê°„ì„ ì£¼ì„¸ìš”." },
  { n:"IX. ì€ë‘”ì (The Hermit) ğŸ•¯ï¸",
    u:["ì„±ì°°","ì—°êµ¬","ì§‘ì¤‘"], r:["ê³ ë¦½","ì§€ì—°","íì‡„"],
    au:"í˜¼ìë§Œì˜ ëª°ì…ì´ ë‹µì„ ì¤ë‹ˆë‹¤.",
    ar:"ë„ì›€ ìš”ì²­ë„ ìš©ê¸°ì…ë‹ˆë‹¤. ê³ ë¦½ì„ ëŠìœ¼ì„¸ìš”." },
  { n:"X. ìš´ëª…ì˜ ìˆ˜ë ˆë°”í€´ (Wheel of Fortune) ğŸ¡",
    u:["ì „í™˜","í–‰ìš´","ìˆœí™˜"], r:["ë³€ë•","í†µì œë¶ˆê°€","íƒ€ì´ë°ì•…"],
    au:"ì˜¤ëŠ” íŒŒë„ë¥¼ íƒ€ì„¸ìš”. íƒ€ì´ë°ì´ ê³§ ì‹¤ë ¥!",
    ar:"ì§€ê¸ˆì€ í° ë² íŒ…ë³´ë‹¤ ê´€ë§ì´ ìœ ë¦¬í•´ìš”." },
  { n:"XI. ì •ì˜ (Justice) âš–ï¸",
    u:["ê³µì •","ê³„ì•½","ê· í˜•"], r:["ë¶ˆê· í˜•","ë¶ˆì´ìµ","í¸í–¥"],
    au:"ì‚¬ì‹¤ê³¼ ê·œì •ì„ ê¸°ì¤€ìœ¼ë¡œ íŒë‹¨í•˜ì„¸ìš”.",
    ar:"ê°ì • ì„ì¸ ê²°ì •ì€ ì†í•´. ìë£Œë¥¼ ë‹¤ì‹œ ë³´ì„¸ìš”." },
  { n:"XII. ë§¤ë‹¬ë¦° ì‚¬ëŒ (The Hanged Man) ğŸª¢",
    u:["ì‹œê°ì „í™˜","í¬ìƒ","ë©ˆì¶¤"], r:["ì§€ì²´","ê³ ì§‘","ë¹„íš¨ìœ¨"],
    au:"ì ì‹œ ë©ˆì¶¤ì´ ë„ì•½ì„ ë§Œë“­ë‹ˆë‹¤. ê°ë„ë¥¼ ë°”ê¿”ë³´ì„¸ìš”.",
    ar:"ì• ì¨ ë§‰ ëŒì§€ ë§ê³ , ë‚´ë ¤ë†“ì„ ê±´ ë‚´ë ¤ë†“ê¸°." },
  { n:"XIII. ì£½ìŒ (Death) ğŸ¦‹",
    u:["ì¢…ê²°","ì •ë¦¬","ì¬ìƒ"], r:["ì§‘ì°©","ë¯¸ë£¨ê¸°","ì •ì²´"],
    au:"ë‚¡ì€ ê²ƒì„ ëë‚´ì•¼ ìƒˆ ê²ƒì´ ì˜µë‹ˆë‹¤.",
    ar:"ë¶™ì¡ëŠ” ì†ì„ í´ë©´, íë¦„ì´ ëŒì•„ì˜µë‹ˆë‹¤." },
  { n:"XIV. ì ˆì œ (Temperance) ğŸ’§",
    u:["ì¡°ìœ¨","ê· í˜•","ì¹˜ìœ "], r:["ê³¼ìœ ë¶ˆê¸‰","ê¸°ë³µ","ì‹¤ìˆ˜"],
    au:"70%ì˜ ì¡°í™”ê°€ 100ì ì˜ ê²°ê³¼ë¥¼ ë¶€ë¦…ë‹ˆë‹¤.",
    ar:"ë¬´ë¦¬ìˆ˜ ê¸ˆì§€. ì†ë„Â·ì–‘ì„ ë‚®ì¶° ë¯¸ì„¸ì¡°ì •!" },
  { n:"XV. ì•…ë§ˆ (The Devil) ğŸ”—",
    u:["ì§‘ì°©","ìœ í˜¹","ê³„ì•½"], r:["í•´ë°©","ìê°","ì ˆì œ"],
    au:"ë‹¬ì½¤í•œ ìœ í˜¹ì—” ê°€ê²©í‘œê°€ ìˆìŠµë‹ˆë‹¤. ì¡°ê±´ì„ ë³´ì„¸ìš”.",
    ar:"ì—°ê²°ê³ ë¦¬ë¥¼ ì¸ì‹í–ˆë‹¤ë©´ ë°˜ì€ ëŠì€ ê²ë‹ˆë‹¤." },
  { n:"XVI. íƒ‘ (The Tower) âš¡",
    u:["ì¶©ê²©","ë¶•ê´´","ê°ì„±"], r:["í”¼í•´ê°ì†Œ","ê²½ê³ ","ë³µêµ¬"],
    au:"ì˜ˆìƒ ë°– ë³€í™”. ê·¸ëŸ¬ë‚˜ ì§„ì§œ ë¬¸ì œë¥¼ ë“œëŸ¬ëƒ…ë‹ˆë‹¤.",
    ar:"ì‘ê²Œ ë¬´ë„ˆì§ˆìˆ˜ë¡ íšŒë³µì´ ë¹ ë¦…ë‹ˆë‹¤. ëŒ€ë¹„í•˜ì„¸ìš”." },
  { n:"XVII. ë³„ (The Star) ğŸŒŸ",
    u:["í¬ë§","ì˜ê°","íšŒë³µ"], r:["ì˜ì‹¬","í˜„ì‹¤íšŒí”¼","ì§€ì—°"],
    au:"ì‘ì€ í¬ë§ì„ í‚¤ìš°ë©´ ê¸¸ì´ ì—´ë¦½ë‹ˆë‹¤.",
    ar:"í¬ë§ì—” ì‹¤í–‰ì´ í•„ìš”í•©ë‹ˆë‹¤. ì²« í–‰ë™ì„!" },
  { n:"XVIII. ë‹¬ (The Moon) ğŸŒ˜",
    u:["ê°ì •","ì§ê°","ê¿ˆ"], r:["ì˜¤í•´","ë¶ˆì•ˆ","ë£¨ë¨¸"],
    au:"ê°ì •ì„ ì ì–´ë³´ì„¸ìš”. ì§„ì§œ í•„ìš”ê°€ ë³´ì…ë‹ˆë‹¤.",
    ar:"í™•ì¦ ì—†ëŠ” ì†Œë¬¸ì€ ë³´ë¥˜. íŒ©íŠ¸ë¥¼ í™•ì¸!" },
  { n:"XIX. íƒœì–‘ (The Sun) â˜€ï¸",
    u:["ì„±ì·¨","ìì‹ ê°","ëª…ë£Œ"], r:["ì§€ì—°","ê³¼ì‹ ","ì†Œì§„"],
    au:"ë°ê²Œ ë°€ê³  ê°€ë©´ ë©ë‹ˆë‹¤. ê³µê°œì ìœ¼ë¡œ ì¶”ì§„!",
    ar:"ê³¼ì‹ ì„ ì¤„ì´ê³ , ì²´ë ¥ ê´€ë¦¬ì— ì§‘ì¤‘í•˜ì„¸ìš”." },
  { n:"XX. ì‹¬íŒ (Judgement) ğŸº",
    u:["ë¶€í™œ","í‰ê°€","ê²°ì •"], r:["í›„íšŒ","ë¯¸ì™„","ì—°ê¸°"],
    au:"ê³¼ê±°ì˜ ìì‹ ì„ í˜¸ì¶œí•´ ê²°ì •ì„ ë§ˆë¬´ë¦¬!",
    ar:"íŒë‹¨ ë³´ë¥˜ OK. ìë£Œë¥¼ ë” ëª¨ìœ¼ì„¸ìš”." },
  { n:"XXI. ì„¸ê³„ (The World) ğŸŒ",
    u:["ì™„ì„±","í†µí•©","ì—¬í–‰"], r:["ë¯¸ì™„ì„±","ë§ˆë¬´ë¦¬ì§€ì—°","í©ì–´ì§"],
    au:"ëê¹Œì§€ ìˆ˜ìŠµí•˜ë©´ ë‹¤ìŒ ë ˆë²¨ì´ ì—´ë¦½ë‹ˆë‹¤.",
    ar:"ë§ˆë¬´ë¦¬ ì²´í¬ë¦¬ìŠ¤íŠ¸ë¡œ ëˆ„ë½ì„ ë§‰ìœ¼ì„¸ìš”." },
];

/**************** ìœ í‹¸ ****************/
const $ = sel => document.querySelector(sel);
const dateText = $("#dateText");
const isReduced = window.matchMedia('(prefers-reduced-motion: reduce)').matches;
function fmtDateHuman(){ return new Intl.DateTimeFormat("ko-KR",{dateStyle:"full"}).format(new Date()).replace(/\s*ì—­\s*$/,""); }
function clamp(n, min, max){ return Math.max(min, Math.min(max, n)); }

// LCG ê¸°ë°˜ ì‹œë“œ ë‚œìˆ˜ (ë§í¬ ê³µìœ ìš© ì¬í˜„ ê°€ëŠ¥)
function LCG(seed){ let s = seed>>>0; return () => (s = (s*1664525 + 1013904223)>>>0) / 2**32 }
function parseSeed(){ const u=new URL(location.href); const s=u.searchParams.get('s'); return s? Number(s): null }
function makeSeedLink(res){ const u=new URL(location.href); const seed = (res.seed||Date.now())>>>0; u.searchParams.set('s', String(seed)); return u.toString() }

/**************** ì—˜ë¦¬ë¨¼íŠ¸ ****************/
const cardEl   = $("#card");
const nameEl   = $("#cardName");
const dirEl    = $("#cardDir");
const kwEl     = $("#keywords");
const advEl    = $("#advice");
const drawBtn  = $("#drawBtn");
const flipBtn  = $("#flipBtn");
const shareBtn = $("#shareBtn");
const linkBtn  = $("#linkBtn");
const resetBtn = $("#resetBtn");

const tabGeneral = $("#tabGeneral");
const tabLove = $("#tabLove");
const tabWork = $("#tabWork");
const tabMoney = $("#tabMoney");
const panelTitle = $("#panelTitle");
const line1 = $("#line1");
const line2 = $("#line2");
const line3 = $("#line3");
const historyEl = $("#history");

/**************** ìƒíƒœ ****************/
let currentRes = null; // {idx, upright, ts, seed}
let currentTab = "general";
const HISTORY_KEY = 'tarotHistoryV2';

/**************** ë Œë”ë§ ****************/
function renderResult(res){
  if(!res){
    nameEl.textContent = "ì¹´ë“œë¥¼ ë½‘ì•„ë³´ì„¸ìš”";
    dirEl.textContent = "ì •/ì—­ë°©í–¥";
    kwEl.innerHTML = "";
    advEl.textContent = "ì—¬ê¸°ì— ë©”ì‹œì§€ê°€ í‘œì‹œë©ë‹ˆë‹¤.";
    advEl.className = "advice";
    renderDomainPanel(null);
    return;
  }
  const card = MAJOR[res.idx];
  const isUpright = res.upright;
  nameEl.textContent = card.n;
  dirEl.textContent = isUpright ? "ì •ë°©í–¥" : "ì—­ë°©í–¥";
  kwEl.innerHTML = "";
  (isUpright?card.u:card.r).forEach(k=>{
    const span=document.createElement("span"); span.className="pill"; span.textContent=k; kwEl.appendChild(span);
  });
  advEl.textContent = isUpright ? card.au : card.ar;
  advEl.className = "advice " + (isUpright ? "good" : (res.idx===15||res.idx===16 ? "bad" : ""));
  renderDomainPanel(res);
}
function renderDomainPanel(res){
  if(!res){
    panelTitle.textContent = "ì˜¤ëŠ˜ì˜ í•µì‹¬";
    line1.textContent = "ì¹´ë“œë¥¼ ë½‘ìœ¼ë©´ ë¶„ì•¼ë³„ í•´ì„ì´ í‘œì‹œë©ë‹ˆë‹¤.";
    line2.textContent = ""; line3.textContent = "";
    return;
  }
  const card = MAJOR[res.idx];
  if(currentTab==="general"){
    panelTitle.textContent = "í•µì‹¬ ìš”ì•½";
    line1.textContent = (res.upright?card.au:card.ar);
    line2.textContent = `í‚¤ì›Œë“œ: ${(res.upright?card.u:card.r).join(", ")}`;
    line3.textContent = `ì¹´ë“œ: ${card.n} Â· ${res.upright?"ì •ë°©í–¥":"ì—­ë°©í–¥"}`;
  }else if(currentTab==="love"){
    panelTitle.textContent = "ì‚¬ë‘ ìš´ì„¸";
    line1.textContent = domainAdvice(card, res.upright, "love");
    line2.textContent = "â˜‘ï¸ ëŒ€í™”ì˜ ì§ˆ > íšŸìˆ˜ Â· ê²½ê³„/ê¸°ëŒ€ì¹˜ ì¡°ìœ¨";
    line3.textContent = "íŒ: ì‘ì€ ì¹œì ˆ/ë©”ì‹œì§€ë¡œ ë¦¬ë“œí•´ë³´ì„¸ìš”.";
  }else if(currentTab==="work"){
    panelTitle.textContent = "ì¼(ì»¤ë¦¬ì–´) ìš´ì„¸";
    line1.textContent = domainAdvice(card, res.upright, "work");
    line2.textContent = "â˜‘ï¸ ì˜¤ëŠ˜ í•œ ê°€ì§€ ì™„ì£¼ Â· ë°ì´í„°ë¡œ ì„¤ë“";
    line3.textContent = "íŒ: ë§ˆê°Â·ì˜ì‚¬ê²°ì • í¬ì¸íŠ¸ë¥¼ ë¨¼ì € ì ê¸°";
  }else{
    panelTitle.textContent = "ê¸ˆì „ ìš´ì„¸";
    line1.textContent = domainAdvice(card, res.upright, "money");
    line2.textContent = "â˜‘ï¸ ì¶©ë™êµ¬ë§¤ ë°©ì§€ Â· êµ¬ë…/ê³ ì •ë¹„ ì ê²€";
    line3.textContent = "íŒ: ì˜¤ëŠ˜ì€ ë¹„êµÂ·ë³´ë¥˜Â·ì˜ˆë¹„ë¹„ ê°•í™”";
  }
}

/**************** ë¶„ì•¼ë³„ í•´ì„ ****************/
const pick = (arr)=> arr[Math.floor(Math.random()*arr.length)];
function domainAdvice(card, upright, domain){
  const T = {
    love:{
      u:[
        "ê°ì •ì˜ {tone} íë¦„. ì†”ì§í•œ ëŒ€í™”ê°€ ë§¤ë ¥ì„ ë†’ì…ë‹ˆë‹¤.",
        "ìƒˆ ì¸ì—°/ê´€ê³„ íšŒë³µ ìš´ì„¸ â†‘. {tip}",
        "ê´€ê³„ì˜ ë¦¬ë“¬ì„ ë§ì¶”ë©´ ê±°ë¦¬ê°ì´ ì¤„ì–´ë“­ë‹ˆë‹¤."
      ],
      r:[
        "ê°ì • ê¸°ë³µ ì£¼ì˜. {trap}ì— íœ˜ë‘˜ë¦¬ì§€ ì•Šë„ë¡ ê²½ê³„í•˜ì„¸ìš”.",
        "ì„œë‘ë¥´ë©´ ì˜¤í•´ê°€ ì»¤ì§‘ë‹ˆë‹¤. {tip}",
        "ê´€ê³„ì˜ ê²½ê³„ ì¬ì„¤ì •ì´ í•„ìš”í•©ë‹ˆë‹¤."
      ],
      tips:["ì‘ì€ ì—°ë½ ë¨¼ì €","ë§Œë‚¨ë³´ë‹¤ ëŒ€í™”ì˜ ì§ˆ","ê°ì • ê¸°ë¡í•˜ê¸°","ê¸°ëŒ€ì¹˜ ì¡°ìœ¨í•˜ê¸°"],
      traps:["ê³¼ë„í•œ ê¸°ëŒ€","í™•ì‹  ì—†ëŠ” ë°€ë‹¹","ë¹„êµ ìŠµê´€","ë‹µì •ë„ˆ ëŒ€í™”"]
    },
    work:{
      u:[
        "ì—…ë¬´ì˜ {tone} íë¦„. í•µì‹¬ 1ê°€ì§€ì— ì§‘ì¤‘í•˜ë©´ ì„±ê³¼ê°€ ë‚©ë‹ˆë‹¤.",
        "ë„ì›€/ë©˜í†  ìš´ì„¸ê°€ ìˆì–´ìš”. {tip}",
        "íƒ€ì´ë°ì´ ì¢‹ìŠµë‹ˆë‹¤. ì‹¤í–‰ì— ì˜®ê¸°ì„¸ìš”."
      ],
      r:[
        "ìš°ì„ ìˆœìœ„ í˜¼ì„  ì£¼ì˜. {trap}ë¥¼ ì¤„ì´ì„¸ìš”.",
        "ì†ë„ë¥¼ ë‚®ì¶”ê³  ì •í•©ì„±ì„ ì ê²€í•  ë•Œì…ë‹ˆë‹¤.",
        "ê´€ì„±ëŒ€ë¡œ ê°€ì§€ ë§ê³  í”„ë¡œì„¸ìŠ¤ë¥¼ ì¬ì •ë¹„í•˜ì„¸ìš”."
      ],
      tips:["ë ˆí¼ëŸ°ìŠ¤ í™•ë³´","ë©”ëª¨ë¡œ íë¦„ ì¡ê¸°","ì˜¤ëŠ˜ 1íƒœìŠ¤í¬ ì™„ì£¼","ë°ë“œë¼ì¸ ì¬í™•ì¸"],
      traps:["íšŒì˜ ê³¼ë‹¤","ì»¨í…ìŠ¤íŠ¸ ìŠ¤ìœ„ì¹­","ë¯¸ë£¨ê¸°","ì™„ë²½ì£¼ì˜ ë£¨í”„"]
    },
    money:{
      u:[
        "í˜„ê¸ˆíë¦„ì´ {tone}. {tip}ì— í¬ì»¤ìŠ¤ í•˜ì„¸ìš”.",
        "ì‘ì€ ì ˆì•½/ìˆ˜ìµí™” ì•„ì´ë””ì–´ê°€ íš¨ìœ¨ì„ ë§Œë“­ë‹ˆë‹¤.",
        "ê³„íšì  ì§€ì¶œì´ ìˆ˜ìµë¥ ì„ ì§€í‚µë‹ˆë‹¤."
      ],
      r:[
        "ì¶©ë™ì†Œë¹„/ê³¼ì‹  ì£¼ì˜. {trap} í”¼í•˜ê¸°.",
        "í° ë² íŒ…ì€ ë³´ë¥˜. í˜„ê¸ˆì¿ ì…˜ì„ ë¨¼ì €.",
        "ì¡°ê±´ í™•ì¸ ì—†ì´ ì„œëª… ê¸ˆì§€â€”ì¡°í•­ì„ ì¬ê²€í† !"
      ],
      tips:["ì§€ì¶œ ì¹´í…Œê³ ë¦¬ ì œí•œ","êµ¬ë… ì ê²€","ê°€ê²© ë¹„êµ","ì˜ˆë¹„ë¹„ ìš°ì„ "],
      traps:["ë¬´ì´ìì— ë°©ì‹¬","í• ì¸ ìœ í˜¹","ì •ë³´ ë¹„ëŒ€ì¹­","ìˆ˜ìµë¥  ê³¼ëŒ€í‰ê°€"]
    }
  };
  const tone = upright ? pick(["ë§‘ê³  ê²½ì¾Œí•œ","ì•ˆì •ì ì¸","í™•ì¥ì ì¸"]) : pick(["ìš¸í‰ë¶ˆí‰í•œ","íë¦¿í•œ","ë³€ë•ìŠ¤ëŸ¬ìš´"]);
  const kws = upright ? card.u : card.r;
  const tpl = upright ? pick(T[domain].u) : pick(T[domain].r);
  const tip = pick(T[domain].tips);
  const trap = pick(T[domain].traps);
  return tpl.replace("{tone}", kws[0]||"íë¦„").replace("{tip}", tip).replace("{trap}", trap);
}

/**************** íˆìŠ¤í† ë¦¬ ****************/
function loadHistory(){
  try{ return JSON.parse(localStorage.getItem(HISTORY_KEY)||'[]'); }catch{ return [] }
}
function saveHistory(list){
  try{ localStorage.setItem(HISTORY_KEY, JSON.stringify(list.slice(0,10))); }catch{}
}
function pushHistory(res){
  const card = MAJOR[res.idx];
  const entry = { t: res.ts, n: card.n, u: res.upright, s: res.seed||null };
  const list = [entry, ...loadHistory()].slice(0,10);
  saveHistory(list); renderHistory(list);
}
function renderHistory(list=loadHistory()){
  historyEl.innerHTML = '';
  if(!list.length){ historyEl.innerHTML = '<div class="date">ê¸°ë¡ ì—†ìŒ</div>'; return; }
  list.forEach(e=>{
    const div = document.createElement('div'); div.className='hist-item';
    const dot = document.createElement('div'); dot.className = 'dot '+(e.u?'u':'r'); div.appendChild(dot);
    const txt = document.createElement('div');
    const d = new Date(e.t);
    txt.textContent = `${new Intl.DateTimeFormat('ko-KR',{month:'numeric',day:'numeric',hour:'2-digit',minute:'2-digit'}).format(d)} Â· ${e.n} Â· ${e.u?'ì •':'ì—­'}`;
    div.appendChild(txt);
    div.addEventListener('click',()=>{
      // ì¬í˜„ ë§í¬ê°€ ìˆìœ¼ë©´ ì—´ê¸°, ì—†ìœ¼ë©´ í˜„ì¬ì— ì ìš©
      if(e.s!=null){ location.href = setSeedInUrl(e.s); }
      else { currentRes = { idx: nameToIndex(e.n), upright:e.u, ts: Date.now() }; renderResult(currentRes); flipCard(true); }
    });
    historyEl.appendChild(div);
  });
}
function nameToIndex(name){ return clamp(MAJOR.findIndex(c=>c.n===name),0,MAJOR.length-1) }
function setSeedInUrl(seed){ const u=new URL(location.href); u.searchParams.set('s', String(seed>>>0)); return u.toString(); }

/**************** ë™ì‘ ****************/
function flipCard(toBack=true){
  const flipped = cardEl.classList.contains("flipped");
  if(toBack && !flipped) cardEl.classList.add("flipped");
  if(!toBack && flipped) cardEl.classList.remove("flipped");
}
function drawRandom(){
  // ì‹œë“œ íŒŒë¼ë¯¸í„°ê°€ ìˆìœ¼ë©´ ì¬í˜„ê°€ëŠ¥ ê²°ê³¼ ìƒì„±
  const seedParam = parseSeed();
  if(seedParam!=null){
    const rnd = LCG(seedParam);
    const idx = Math.floor(rnd()*MAJOR.length);
    const upright = rnd() < 0.5;
    return { idx, upright, ts: Date.now(), seed: seedParam };
  }
  const idx = Math.floor(Math.random()*MAJOR.length);
  const upright = Math.random() < 0.5;
  return { idx, upright, ts: Date.now(), seed: Date.now() };
}
function applyDraw({autoFlipDelay=250}={}){
  const res = drawRandom();
  currentRes = res;
  renderResult(res);
  if(navigator.vibrate) try{ navigator.vibrate(8); }catch{}
  if(!isReduced) setTimeout(()=>flipCard(true), autoFlipDelay);
  pushHistory(res);
}
function setTab(tab){
  currentTab = tab;
  [tabGeneral,tabLove,tabWork,tabMoney].forEach(b=>b.setAttribute("aria-selected","false"));
  ({"general":tabGeneral,"love":tabLove,"work":tabWork,"money":tabMoney}[tab]).setAttribute("aria-selected","true");
  renderDomainPanel(currentRes);
}

/**************** ì´ë²¤íŠ¸ ****************/
drawBtn.addEventListener("click", ()=>applyDraw({autoFlipDelay:250}));
flipBtn.addEventListener("click", ()=> cardEl.classList.toggle("flipped"));
cardEl.addEventListener("click", ()=> cardEl.classList.toggle("flipped"));
cardEl.addEventListener("keydown", (e)=>{ if(e.key==="Enter"||e.key===" "){ e.preventDefault(); cardEl.classList.toggle('flipped'); }});
resetBtn.addEventListener("click", ()=>{
  currentRes = null; renderResult(null); flipCard(false);
});
shareBtn.addEventListener("click", async ()=>{
  if(!currentRes){ alert("ë¨¼ì € ì¹´ë“œë¥¼ ë½‘ì•„ì£¼ì„¸ìš”!"); return; }
  const c = MAJOR[currentRes.idx];
  const dir = currentRes.upright ? "ì •ë°©í–¥" : "ì—­ë°©í–¥";
  const kws = (currentRes.upright ? c.u : c.r).join(", ");
  const msg = `ğŸ”® ì˜¤ëŠ˜ì˜ íƒ€ë¡œ (${fmtDateHuman()})\nì¹´ë“œ: ${c.n} Â· ${dir}\ní‚¤ì›Œë“œ: ${kws}\ní•µì‹¬: ${currentRes.upright ? c.au : c.ar}`;
  try{
    if (navigator.share) await navigator.share({ title:"ì˜¤ëŠ˜ì˜ íƒ€ë¡œ", text:msg });
    else { await navigator.clipboard.writeText(msg); alert("ë³µì‚¬ ì™„ë£Œ! ì›í•˜ëŠ” ê³³ì— ë¶™ì—¬ë„£ê¸° í•˜ì„¸ìš”."); }
  }catch(e){}
});
linkBtn.addEventListener('click', async ()=>{
  if(!currentRes){ alert('ë¨¼ì € ì¹´ë“œë¥¼ ë½‘ì•„ì£¼ì„¸ìš”!'); return; }
  const url = makeSeedLink(currentRes);
  try{ await navigator.clipboard.writeText(url); alert('ë§í¬ê°€ ë³µì‚¬ë˜ì—ˆìŠµë‹ˆë‹¤!'); }
  catch{ prompt('ì•„ë˜ ë§í¬ë¥¼ ë³µì‚¬í•˜ì„¸ìš”', url); }
});

// íƒ­
[ [tabGeneral,'general'],[tabLove,'love'],[tabWork,'work'],[tabMoney,'money'] ].forEach(([btn,tab])=> btn.addEventListener('click',()=>setTab(tab)) );

// ë‹¨ì¶•í‚¤
window.addEventListener('keydown',(e)=>{
  if(e.target && ['INPUT','TEXTAREA'].includes(e.target.tagName)) return;
  if(e.key==='d' || e.key==='D') applyDraw({autoFlipDelay:200});
  if(e.key==='f' || e.key==='F') cardEl.classList.toggle('flipped');
  if(e.key==='l' || e.key==='L') linkBtn.click();
});

// ì´ˆê¸°
function init(){
  dateText.textContent = fmtDateHuman();
  renderHistory();
  // ì‹œë“œê°€ ìˆëŠ” ê²½ìš° ìë™ ë½‘ê¸° + ë°”ë¡œ ë’¤ì§‘ê¸°
  if(parseSeed()!=null){ applyDraw({autoFlipDelay: isReduced?0:120}); }
}
init();
</script>
</body>
</html>
